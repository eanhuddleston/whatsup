<div class="row">
<div class="span7"> <!-- row1, column1 -->
  <h3>Events Within <%= @distance %> Miles Of Your Location:</h3>
  <div id="map" style="width: 550px; height: 400px;"></div>
</div> <!-- left column -->

<div class="span3"> <!-- row1, column2 -->
  <div id="refine-search">
    <h4>Narrow Search:</h4>

    <%= form_tag home_url, :method => :get do %>
        <%= text_field_tag :distance %>
        <span class="muted">Miles From Home</span>
        <br>
        <% @avail_categories.each do |category| %>
          <%= check_box_tag(
                "categories[]",
                category.id,
                @selected_categories.include?(category)
              )
          %>
        <%= category.name %><br>
      <% end %>
      <%= hidden_field_tag :prev_distance, @distance %>
      <br>
      <%= submit_tag "Search", class: "btn btn-primary", type: "button" %>

    <% end %>
  </div>
</div> <!-- end right column -->

</div> <!-- end first row -->
<br>
<div class="row">
  <div class="span7">
    <table class="table table-striped">
      <% @trimmed_events.each do |event| %>
        <tr><div data-eventid="<%=event.id%>"><%= link_to event.title, event %> (<%= event.distance.round(2) %> miles)</div></tr>
      <% end %>
    </table>
  </div>
</div>

<%= link_to "Add Event", new_event_url %>
<br>
<%= link_to "All Events", events_url %>

<script src="http://maps.google.com/maps/api/js?sensor=false&v=3.11" 
    type="text/javascript"></script>

<script type="text/javascript">
google.maps.event.addDomListener(window, 'load', initialize);

window.userLoc = <%= @user_loc.to_json.html_safe %>
window.eventsWithinRange = <%= @events_within_range.to_json.html_safe %>
window.trimmedEvents = <%= @trimmed_events.to_json.html_safe %>

</script>